// Translations
const translations = {
    en: {
        'nav.services': 'Services',
        'nav.portfolio': 'Portfolio',
        'nav.about': 'About',
        'nav.contact': 'Contact',
        'hero.badge': 'AI-Powered Web Agency',
        'hero.title': 'Websites at Lightning Speed',
        'hero.subtitle': 'Lowest price. Fastest delivery. Cutting-edge tech. We use AI to build your website in days, not months.',
        'hero.cta': 'Get Started',
        'hero.tech': 'See Tech Stack',
        'hero.trusted': 'Game-changing web development for the AI era',
        'services.title': 'Our Services',
        'services.design.title': 'UI/UX Design',
        'services.design.desc': 'Figma, Adobe XD, Prototyping. User research and wireframing to pixel-perfect interfaces.',
        'services.web.title': 'Web Development',
        'services.web.desc': 'React, Vue, Next.js, Nuxt. Server-side rendering, PWA, and JAMstack architecture.',
        'services.ecommerce.title': 'E-Commerce Solutions',
        'services.ecommerce.desc': 'Shopify, WooCommerce, custom solutions. Payment gateway integration and inventory management.',
        'services.seo.title': 'SEO & Performance',
        'services.seo.desc': 'Core Web Vitals optimization, technical SEO, and analytics setup for measurable growth.',
        'tech.title': 'Technology Stack',
        'tech.subtitle': 'We leverage modern technologies to build fast, secure, and scalable solutions',
        'tech.frontend': 'Frontend',
        'tech.backend': 'Backend',
        'tech.database': 'Database',
        'tech.cloud': 'Cloud & DevOps',
        'portfolio.title': 'Featured Works',
        'portfolio.tech.title': 'Tech Company Website',
        'portfolio.tech.cat': 'Next.js + Tailwind',
        'portfolio.fashion.title': 'Fashion E-Commerce',
        'portfolio.fashion.cat': 'Shopify + React',
        'portfolio.fnb.title': 'F&B Brand Website',
        'portfolio.fnb.cat': 'Vue.js + Laravel',
        'portfolio.edu.title': 'Education Platform',
        'portfolio.edu.cat': 'React + Node.js',
        'about.title': 'About Us',
        'about.desc': 'RubyMedia is a full-stack development agency based in Singapore. We specialize in building high-performance web applications using modern technologies. Our team of experienced developers and designers work closely with clients to deliver solutions that drive business growth.',
        'about.projects': 'Projects Delivered',
        'about.clients': 'Happy Clients',
        'about.years': 'Years Experience',
        'contact.title': 'Contact Us',
        'contact.subtitle': 'Ready to start your project? Let\'s talk.',
        'contact.whatsapp': 'Chat on WhatsApp',
        'footer.tagline': 'Building Digital Excellence',
    },
    zh: {
        'nav.services': '服务',
        'nav.portfolio': '案例',
        'nav.about': '关于',
        'nav.contact': '联系',
        'hero.badge': 'AI 驱动的建站公司',
        'hero.title': '闪电速度交付网站',
        'hero.subtitle': '最低价格 · 最快速度 · 最新技术。AI 赋能，几天交付，颠覆传统建站。',
        'hero.cta': '立即开始',
        'hero.tech': '查看技术栈',
        'hero.trusted': 'AI 时代的游戏规则改变者',
        'services.title': '我们的服务',
        'services.design.title': 'UI/UX 设计',
        'services.design.desc': 'Figma、Adobe XD、原型设计。从用户研究、线框图到像素级精美界面。',
        'services.web.title': '网站开发',
        'services.web.desc': 'React、Vue、Next.js、Nuxt。服务端渲染、PWA、JAMstack 架构。',
        'services.ecommerce.title': '电商解决方案',
        'services.ecommerce.desc': 'Shopify、WooCommerce、定制开发。支付网关集成与库存管理系统。',
        'services.seo.title': 'SEO 与性能优化',
        'services.seo.desc': 'Core Web Vitals 优化、技术 SEO、数据分析，实现可量化的增长。',
        'tech.title': '技术栈',
        'tech.subtitle': '我们采用现代化技术构建快速、安全、可扩展的解决方案',
        'tech.frontend': '前端技术',
        'tech.backend': '后端技术',
        'tech.database': '数据库',
        'tech.cloud': '云服务 & DevOps',
        'portfolio.title': '精选案例',
        'portfolio.tech.title': '科技公司官网',
        'portfolio.tech.cat': 'Next.js + Tailwind',
        'portfolio.fashion.title': '时尚电商平台',
        'portfolio.fashion.cat': 'Shopify + React',
        'portfolio.fnb.title': '餐饮品牌网站',
        'portfolio.fnb.cat': 'Vue.js + Laravel',
        'portfolio.edu.title': '在线教育平台',
        'portfolio.edu.cat': 'React + Node.js',
        'about.title': '关于我们',
        'about.desc': 'RubyMedia 是一家总部位于新加坡的全栈开发工作室，专注于使用现代化技术构建高性能 Web 应用。我们经验丰富的开发者和设计师团队与客户紧密合作，交付驱动业务增长的解决方案。',
        'about.projects': '交付项目',
        'about.clients': '合作客户',
        'about.years': '年经验',
        'contact.title': '联系我们',
        'contact.subtitle': '准备开始您的项目？让我们聊聊。',
        'contact.whatsapp': 'WhatsApp 咨询',
        'footer.tagline': '打造卓越数字体验',
        'form.success': '感谢留言！我们将在 24 小时内回复您。'
    },
    ms: {
        'nav.services': 'Perkhidmatan',
        'nav.portfolio': 'Portfolio',
        'nav.about': 'Tentang Kami',
        'nav.contact': 'Hubungi',
        'hero.badge': 'Agensi Web Berkuasa AI',
        'hero.title': 'Laman Web Sepantas Kilat',
        'hero.subtitle': 'Harga terendah. Penghantaran terpantas. Teknologi terkini. AI membina laman web anda dalam beberapa hari.',
        'hero.cta': 'Mula Sekarang',
        'hero.tech': 'Lihat Teknologi',
        'hero.trusted': 'Mengubah permainan pembangunan web era AI',
        'services.title': 'Perkhidmatan Kami',
        'services.design.title': 'Reka Bentuk UI/UX',
        'services.design.desc': 'Figma, Adobe XD, Prototaip. Kajian pengguna dan wireframe hingga antara muka pixel-perfect.',
        'services.web.title': 'Pembangunan Web',
        'services.web.desc': 'React, Vue, Next.js, Nuxt. Server-side rendering, PWA, dan seni bina JAMstack.',
        'services.ecommerce.title': 'Penyelesaian E-Dagang',
        'services.ecommerce.desc': 'Shopify, WooCommerce, penyelesaian tersuai. Integrasi gerbang pembayaran dan pengurusan inventori.',
        'services.seo.title': 'SEO & Prestasi',
        'services.seo.desc': 'Pengoptimuman Core Web Vitals, SEO teknikal, dan persediaan analitik untuk pertumbuhan.',
        'tech.title': 'Stack Teknologi',
        'tech.subtitle': 'Kami menggunakan teknologi moden untuk membina penyelesaian yang pantas, selamat dan berskala',
        'tech.frontend': 'Frontend',
        'tech.backend': 'Backend',
        'tech.database': 'Pangkalan Data',
        'tech.cloud': 'Cloud & DevOps',
        'portfolio.title': 'Karya Terpilih',
        'portfolio.tech.title': 'Laman Web Syarikat Teknologi',
        'portfolio.tech.cat': 'Next.js + Tailwind',
        'portfolio.fashion.title': 'E-Dagang Fesyen',
        'portfolio.fashion.cat': 'Shopify + React',
        'portfolio.fnb.title': 'Laman Web Jenama F&B',
        'portfolio.fnb.cat': 'Vue.js + Laravel',
        'portfolio.edu.title': 'Platform Pendidikan',
        'portfolio.edu.cat': 'React + Node.js',
        'about.title': 'Tentang Kami',
        'about.desc': 'RubyMedia adalah agensi pembangunan full-stack yang berpangkalan di Singapura. Kami pakar dalam membina aplikasi web berprestasi tinggi menggunakan teknologi moden. Pasukan pembangun dan pereka berpengalaman kami bekerjasama rapat dengan pelanggan.',
        'about.projects': 'Projek Dihantar',
        'about.clients': 'Pelanggan Gembira',
        'about.years': 'Tahun Pengalaman',
        'contact.title': 'Hubungi Kami',
        'contact.subtitle': 'Bersedia untuk memulakan projek anda? Mari bercakap.',
        'contact.whatsapp': 'Sembang di WhatsApp',
        'footer.tagline': 'Membina Kecemerlangan Digital',
        'form.success': 'Terima kasih! Kami akan menghubungi anda dalam 24 jam.'
    },
    ta: {
        'nav.services': 'சேவைகள்',
        'nav.portfolio': 'படைப்புகள்',
        'nav.about': 'எங்களைப் பற்றி',
        'nav.contact': 'தொடர்பு',
        'hero.badge': 'AI-இயக்கும் வலை ஏஜென்சி',
        'hero.title': 'மின்னல் வேகத்தில் வலைத்தளங்கள்',
        'hero.subtitle': 'குறைந்த விலை. வேகமான டெலிவரி. சமீபத்திய தொழில்நுட்பம். AI உங்கள் வலைத்தளத்தை நாட்களில் உருவாக்குகிறது.',
        'hero.cta': 'இப்போது தொடங்கு',
        'hero.tech': 'தொழில்நுட்பம் காண்க',
        'hero.trusted': 'AI சகாப்தத்தின் கேம் சேஞ்சர்',
        'services.title': 'எங்கள் சேவைகள்',
        'services.design.title': 'UI/UX வடிவமைப்பு',
        'services.design.desc': 'Figma, Adobe XD, முன்மாதிரி. பயனர் ஆராய்ச்சி முதல் பிக்சல்-சரியான இடைமுகங்கள் வரை.',
        'services.web.title': 'வலை மேம்பாடு',
        'services.web.desc': 'React, Vue, Next.js, Nuxt. சர்வர்-சைட் ரெண்டரிங், PWA மற்றும் JAMstack கட்டமைப்பு.',
        'services.ecommerce.title': 'இ-வணிக தீர்வுகள்',
        'services.ecommerce.desc': 'Shopify, WooCommerce, தனிப்பயன் தீர்வுகள். பேமென்ட் கேட்வே மற்றும் சரக்கு மேலாண்மை.',
        'services.seo.title': 'SEO & செயல்திறன்',
        'services.seo.desc': 'Core Web Vitals மேம்படுத்தல், தொழில்நுட்ப SEO மற்றும் அனலிட்டிக்ஸ் அமைப்பு.',
        'tech.title': 'தொழில்நுட்ப அடுக்கு',
        'tech.subtitle': 'வேகமான, பாதுகாப்பான மற்றும் அளவிடக்கூடிய தீர்வுகளை உருவாக்க நவீன தொழில்நுட்பங்களைப் பயன்படுத்துகிறோம்',
        'tech.frontend': 'முன்பக்கம்',
        'tech.backend': 'பின்பக்கம்',
        'tech.database': 'தரவுத்தளம்',
        'tech.cloud': 'கிளவுட் & DevOps',
        'portfolio.title': 'சிறந்த படைப்புகள்',
        'portfolio.tech.title': 'தொழில்நுட்ப நிறுவன வலைத்தளம்',
        'portfolio.tech.cat': 'Next.js + Tailwind',
        'portfolio.fashion.title': 'பேஷன் இ-வணிகம்',
        'portfolio.fashion.cat': 'Shopify + React',
        'portfolio.fnb.title': 'உணவு பிராண்ட் வலைத்தளம்',
        'portfolio.fnb.cat': 'Vue.js + Laravel',
        'portfolio.edu.title': 'கல்வி தளம்',
        'portfolio.edu.cat': 'React + Node.js',
        'about.title': 'எங்களைப் பற்றி',
        'about.desc': 'RubyMedia சிங்கப்பூரை தளமாகக் கொண்ட முழு அடுக்கு மேம்பாட்டு ஏஜென்சி. நவீன தொழில்நுட்பங்களைப் பயன்படுத்தி உயர் செயல்திறன் வலை பயன்பாடுகளை உருவாக்குவதில் நிபுணத்துவம் பெற்றவர்கள்.',
        'about.projects': 'திட்டங்கள்',
        'about.clients': 'வாடிக்கையாளர்கள்',
        'about.years': 'ஆண்டுகள்',
        'contact.title': 'எங்களைத் தொடர்புகொள்ளுங்கள்',
        'contact.subtitle': 'உங்கள் திட்டத்தைத் தொடங்க தயாரா? பேசுவோம்.',
        'contact.whatsapp': 'WhatsApp இல் அரட்டை',
        'footer.tagline': 'டிஜிட்டல் சிறப்பை உருவாக்குதல்',
        'form.success': 'நன்றி! 24 மணி நேரத்தில் தொடர்புகொள்வோம்.'
    }
};

let currentLang = 'en';

// Language switcher
function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('preferredLang', lang);

    // Update text content
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    // Update placeholders
    document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (translations[lang] && translations[lang][key]) {
            el.placeholder = translations[lang][key];
        }
    });

    // Update active button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === lang) {
            btn.classList.add('active');
        }
    });

    // Update html lang attribute
    document.documentElement.lang = lang === 'zh' ? 'zh-CN' : lang === 'ms' ? 'ms-MY' : lang === 'ta' ? 'ta-SG' : 'en';
}

// Initialize language switcher
document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        setLanguage(btn.getAttribute('data-lang'));
    });
});

// Load saved language preference
const savedLang = localStorage.getItem('preferredLang');
if (savedLang && translations[savedLang]) {
    setLanguage(savedLang);
}

// Mobile menu toggle
const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
const navLinks = document.querySelector('.nav-links');

mobileMenuBtn.addEventListener('click', () => {
    navLinks.classList.toggle('active');
    mobileMenuBtn.classList.toggle('active');
});

// Close mobile menu when clicking a link
navLinks.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
        navLinks.classList.remove('active');
        mobileMenuBtn.classList.remove('active');
    });
});

// Navbar scroll effect
const navbar = document.querySelector('.navbar');

window.addEventListener('scroll', () => {
    if (window.pageYOffset > 50) {
        navbar.classList.add('scrolled');
    } else {
        navbar.classList.remove('scrolled');
    }
});


// Smooth scroll for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Intersection Observer for scroll animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
        }
    });
}, observerOptions);

// Add animation to sections
document.querySelectorAll('section, .service-card, .portfolio-item, .tech-category').forEach(el => {
    el.classList.add('animate-on-scroll');
    observer.observe(el);
});

// ========== THREE.JS 3D BACKGROUND ==========
function initThreeJS() {
    const canvas = document.getElementById('bg-canvas');
    if (!canvas || typeof THREE === 'undefined') return;

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });

    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

    // Create particles
    const particlesGeometry = new THREE.BufferGeometry();
    const particlesCount = 2000;
    const posArray = new Float32Array(particlesCount * 3);

    for (let i = 0; i < particlesCount * 3; i++) {
        posArray[i] = (Math.random() - 0.5) * 10;
    }

    particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

    const particlesMaterial = new THREE.PointsMaterial({
        size: 0.02,
        color: 0xe31837,
        transparent: true,
        opacity: 0.8,
        blending: THREE.AdditiveBlending
    });

    const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
    scene.add(particlesMesh);

    // Add floating geometric shapes
    const shapes = [];
    const geometries = [
        new THREE.IcosahedronGeometry(0.3, 0),
        new THREE.OctahedronGeometry(0.3, 0),
        new THREE.TetrahedronGeometry(0.3, 0),
        new THREE.TorusGeometry(0.2, 0.08, 8, 16)
    ];

    for (let i = 0; i < 8; i++) {
        const geometry = geometries[i % geometries.length];
        const material = new THREE.MeshBasicMaterial({
            color: i % 2 === 0 ? 0xe31837 : 0x667eea,
            wireframe: true,
            transparent: true,
            opacity: 0.3
        });
        const mesh = new THREE.Mesh(geometry, material);
        mesh.position.set(
            (Math.random() - 0.5) * 8,
            (Math.random() - 0.5) * 8,
            (Math.random() - 0.5) * 4 - 2
        );
        mesh.rotation.set(Math.random() * Math.PI, Math.random() * Math.PI, 0);
        shapes.push({
            mesh,
            rotationSpeed: {
                x: (Math.random() - 0.5) * 0.01,
                y: (Math.random() - 0.5) * 0.01
            },
            floatSpeed: Math.random() * 0.5 + 0.5,
            floatOffset: Math.random() * Math.PI * 2
        });
        scene.add(mesh);
    }

    camera.position.z = 3;

    // Animation
    let time = 0;
    function animate() {
        requestAnimationFrame(animate);
        time += 0.01;

        // Rotate particles
        particlesMesh.rotation.y += 0.0005;
        particlesMesh.rotation.x += 0.0002;

        // Animate shapes
        shapes.forEach((shape, i) => {
            shape.mesh.rotation.x += shape.rotationSpeed.x;
            shape.mesh.rotation.y += shape.rotationSpeed.y;
            shape.mesh.position.y += Math.sin(time * shape.floatSpeed + shape.floatOffset) * 0.002;
        });

        renderer.render(scene, camera);
    }

    animate();

    // Handle resize
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
}

// Initialize Three.js when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initThreeJS);
} else {
    initThreeJS();
}

// ========== ANIMATED COUNTER ==========
function animateCounter(element, target, duration = 2000) {
    const start = 0;
    const startTime = performance.now();
    const suffix = element.textContent.replace(/[\d]/g, '');

    function update(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);

        // Easing function (ease-out-expo)
        const easeOutExpo = 1 - Math.pow(2, -10 * progress);
        const current = Math.floor(start + (target - start) * easeOutExpo);

        element.textContent = current + suffix;

        if (progress < 1) {
            requestAnimationFrame(update);
        }
    }

    requestAnimationFrame(update);
}

// Observe stat numbers for counter animation
const counterObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting && !entry.target.dataset.animated) {
            entry.target.dataset.animated = 'true';
            const text = entry.target.textContent;
            const number = parseInt(text.replace(/\D/g, ''));
            if (number) {
                animateCounter(entry.target, number, 2500);
            }
        }
    });
}, { threshold: 0.5 });

document.querySelectorAll('.stat-number').forEach(el => {
    counterObserver.observe(el);
});

// ========== TILT EFFECT ON CARDS (non-following) ==========
document.querySelectorAll('.service-card, .tech-category').forEach(card => {
    card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-10px) rotateX(5deg) rotateY(-5deg)';
    });

    card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0) rotateX(0) rotateY(0)';
    });
});

// ========== MAGNETIC BUTTONS ==========
document.querySelectorAll('.btn-primary').forEach(btn => {
    btn.addEventListener('mousemove', function(e) {
        const rect = this.getBoundingClientRect();
        const x = e.clientX - rect.left - rect.width / 2;
        const y = e.clientY - rect.top - rect.height / 2;
        this.style.transform = `translate(${x * 0.1}px, ${y * 0.1}px)`;
    });

    btn.addEventListener('mouseleave', function() {
        this.style.transform = 'translate(0, 0)';
    });
});

// ========== SMOOTH REVEAL ON SCROLL ==========
const revealElements = document.querySelectorAll('.hero h1, .hero p, .hero-badge, .hero-buttons');
revealElements.forEach((el, i) => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(30px)';
    setTimeout(() => {
        el.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
        el.style.opacity = '1';
        el.style.transform = 'translateY(0)';
    }, 200 + i * 150);
});
